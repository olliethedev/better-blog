---
title: Tanstack Start
description: SSR/SSG with server prefetch and client hydration
---

This renders all blog routes under `/posts/...` with server prefetch + client hydration. Provide separate data providers for server and client.

#### 1) `src/routes/posts/$.tsx` (server)
Create the Better Blog server adapter, prefetch data in the loader, return metadata, and render via `BlogPageRouter`.

```tsx
import { createFileRoute } from "@tanstack/react-router"
import { createBlogServerAdapter } from "better-blog/server/pages";
import { BlogPageRouter } from "better-blog/client"

import { blogDataProvider } from "../../lib/blog-data-provider";

export const Route = createFileRoute("/posts/$")({
  ssr: true,
  head: ({ loaderData }) => {
    const meta = (loaderData ?? null) as
      | {
          title?: string
          description?: string
          openGraph?: { title?: string; description?: string; images?: Array<{ url: string } | string> }
          twitter?: { card?: string; title?: string; description?: string; images?: Array<string> }
        }
      | null

    const ogImage = meta?.openGraph?.images?.[0]
    const ogImageUrl = typeof ogImage === "string" ? ogImage : ogImage?.url

    return {
      meta: [
        meta?.title ? { title: meta.title } : undefined,
        meta?.description ? { name: "description", content: meta.description } : undefined,
        { property: "og:type", content: "article" },
        meta?.openGraph?.title
          ? { property: "og:title", content: meta.openGraph.title }
          : meta?.title
          ? { property: "og:title", content: meta.title }
          : undefined,
        meta?.openGraph?.description
          ? { property: "og:description", content: meta.openGraph.description }
          : meta?.description
          ? { property: "og:description", content: meta.description }
          : undefined,
        ogImageUrl ? { property: "og:image", content: ogImageUrl } : undefined,
        meta?.twitter?.card
          ? { name: "twitter:card", content: meta.twitter.card }
          : { name: "twitter:card", content: ogImageUrl ? "summary_large_image" : "summary" },
        meta?.twitter?.title
          ? { name: "twitter:title", content: meta.twitter.title }
          : meta?.title
          ? { name: "twitter:title", content: meta.title }
          : undefined,
        meta?.twitter?.description
          ? { name: "twitter:description", content: meta.twitter.description }
          : meta?.description
          ? { name: "twitter:description", content: meta.description }
          : undefined,
        ogImageUrl ? { name: "twitter:image", content: ogImageUrl } : undefined,
      ].filter(Boolean) as Array<{ name?: string; property?: string; content?: string; title?: string }>,
    }
  },
  component: RouteComponent,
  loader: async ({ params, context }) => {
    const serverAdapter = createBlogServerAdapter({
      provider: blogDataProvider,
      queryClient: context.queryClient,
    })
    await serverAdapter.prefetch({ path: params._splat })
    const meta = await serverAdapter.generateMetadata(params._splat)
    return meta
  }
})

function RouteComponent() {
  const { _splat } = Route.useParams();
  return <BlogPageRouter path={_splat} />
}
```

#### 2) `src/routes/__root.tsx`
Define the root document and wrap your app with `Provider` to supply context. Uses `createRootRouteWithContext`.

```tsx
// src/routes/__root.tsx
/// <reference types="vite/client" />
import type { ReactNode } from 'react'
import {
  Outlet,
  createRootRouteWithContext,
  HeadContent,
  Scripts,
} from '@tanstack/react-router'
import type { MyRouterContext } from '@/router'
import { Provider } from '@/providers'

import appCss from "@/styles/app.css?url"

export const Route = createRootRouteWithContext<MyRouterContext>()({
  head: () => ({
    meta: [
      {
        charSet: 'utf-8',
      },
      {
        name: 'viewport',
        content: 'width=device-width, initial-scale=1',
      },
      {
        title: 'TanStack Start Starter',
      },
      { property: 'og:type', content: 'website' },
      { property: 'og:title', content: 'Better Blog' },
      { property: 'og:description', content: 'A modern blog powered by Better Blog + TanStack.' },
      { name: 'twitter:card', content: 'summary_large_image' },
      { name: 'twitter:title', content: 'Better Blog' },
      { name: 'twitter:description', content: 'A modern blog powered by Better Blog + TanStack.' },
    ],
    links: [
        {
          rel: "stylesheet",
          href: appCss,
        },
    ],
  }),
  component: RootComponent,
})

function RootComponent() {
  return (
    <RootDocument>
      <Outlet />
    </RootDocument>
  )
}

function RootDocument({ children }: Readonly<{ children: ReactNode }>) {
  return (
    <html>
      <head>
        <meta name="viewport" content="initial-scale=1, viewport-fit=cover, width=device-width" />
        <meta name="theme-color" media="(prefers-color-scheme: light)" content="oklch(1 0 0)" />
        <meta name="theme-color" media="(prefers-color-scheme: dark)" content="oklch(0.145 0 0)" />
        <HeadContent />
      </head>
      <body>
        <Provider>
            {children}
        </Provider>
        <Scripts />
      </body>
    </html>
  )
}
```

#### 3) `src/providers.tsx` (client)
Client-side provider wiring TanStack Router `Link`, navigation helpers, and optional admin UI.

```tsx
"use client";

import { ReactNode } from "react";
import { Link, useRouter } from "@tanstack/react-router"
import { type BlogUIComponents, BlogProvider } from "better-blog/context";

const components: BlogUIComponents = {
  Link: ({ href, children, className }) => (
    <Link to={href} className={className}>
      {children}
    </Link>
  ),
  Image: ({ src, alt, className, width, height }) => (
    <img
      src={src}
      alt={alt}
      className={className}
      width={width || 800}
      height={height || 400}
    />
  ),
};


export function Provider({ children }: { children: ReactNode }) {
  const router = useRouter();

  return (
    <BlogProvider
      localization={{
        BLOG_LIST_TITLE: "Blog Posts",
      }}
      components={components}
      adminPermissions={{
        canCreate:true,
        canUpdate:true,
        canDelete:true
      }}
      navigate={(href) => router.navigate({ href })}
      replace={(href) => router.navigate({ href, replace: true })}
      uploadImage={async (file) => {
        console.log("uploadImage", file);
        //fake wait
        await new Promise((resolve) => setTimeout(resolve, 1000));
        return "https://placehold.co/400";
      }}
    >
      {children}
    </BlogProvider>
  );
}
```

import { Card, Cards } from "fumadocs-ui/components/card";
import { Layers, Router } from "lucide-react";


## What's next?

<Cards>
  <Card
    title="Sitemap generation"
    href="/sitemap"
    icon={<Layers size={20} />}
    description="Generate a sitemap for your blog."
  />
  <Card
    title="API routes"
    href="/api-routes"
    icon={<Router size={20} />}
    description="Ship an API and consume it with the default provider."
  />
</Cards>
